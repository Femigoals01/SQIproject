<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="js.js" type="text/Javascript">
    <!-- <script src="prjct.js"></script> -->
    <style>
        .bdy {
            height: 600px;
            width: 500px;
            border: 2px solid black;
            border-radius: 25px;
            background-color: white;
            display: flex;
        }

        .sidebar {
            height: inherit;
            width: 150px;
            background-color: blue;
            border-radius: 25px 0 0 25px;
        }

        .acctbox {
            height: 100px;
            width: 200px;
            border: none;
            border-radius: 5px;
            min-width: 200px;
            margin: 5px;
            color: white;
            font-size: 20px;
            text-align: center;
        }

        .acctbox1 {
            height: 50px;
            width: 200px;
            border: none;
            border-radius: 5px 5px 5px 0;
            background-color: blue;
            min-width: 200px;
            text-align: center;
            color: white;
            position: absolute;
            right: 0;
        }

        .leftside {
            margin-top: 40px;
        }
        .leftside1 {
            position: absolute; 
            top: 200px;
        }



    </style>
</head>

<body>

    <main id="dashbd" class="row" style=" margin: auto; border: 1px solid black; display: flex; width: 700px; max-width: 100%; height: 650px;">

        
            <div class="col-3" style="border: 0px solid red; background-color: blue;">
                
                    <h4 class="leftside">Piggyvest</h4>
                    <h4 class="leftside">Home</h4>
                    <h4 class="leftside">Savings</h4>
                    <h4 class="leftside">Invest</h4>
                    <h4 class="leftside">Account</h4>
                    <div style="position: relative;">
                    <a href="project.html"><h4 class="leftside1">Logout</h4></a>
                    </div>
                
            </div>

            <div class="col-9" style="border: 0px solid green;">
                <h2 id="dashName">Welcome (Owner Name)</h2>
                <h6 id="ActNoDisplay">Act No:</h6>
                <div style="position: relative;">
                    <div class="acctbox1" type="button" onclick="savMoney()">+ QUICK SAVE</div> <br> <br>
                </div>
                <div style="display: flex; overflow-x: auto;">
                    <div class="acctbox" style="background-color: green;">Total Savings <h3 id="balAccount" type="number">0.00</h3></div>
                    <div class="acctbox" style="background-color: purple;">Total Investment <h3>0.00</h3></div>
                    <div class="acctbox" style="background-color: black;">Flex Dollar <h3>0.00</h3></div>
                    <div class="acctbox" style="background-color: white; color: black;">Flex Naira <h3>0.00</h3></div>
                    <div class="acctbox" style="background-color: palevioletred;">Link Pocketapp <h3>0.00</h3></div>

                </div>

                <main class="row" style="overflow-y: auto; height: fit-content;">
                    <div class="col-7" style="border: 0px solid black;">
                        <h5>To-do List</h5>

                        
                        <div>

                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                verify your email address</div>
                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 70%; margin-top: 10px;">
                                add your BVN or NIN now!</div>
                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                scurely add a validdebit card</div>
                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                set your security question now</div>
                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                redeem your #1000 bonus</div>


                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                See your recent activities

                                See your most recent activities on PiggyVest</div>

                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                Create a Safelock

                                Avoid spending temptations. Tap to create a Safelock</div>

                            <div
                                style="box-sizing: inherit; border: 1px solid lightblue; border-radius: 5px 5px 5px 0; max-width: 100%; margin-top: 10px;">
                                Link your Pocket App

                                Withdraw from your PiggyVest safer & faster ðŸ’œ</div>

                        </div>

                       
                    </div>

                    <div class="col-5" style="border: 0px solid red;">

                        <p>COMPLETE YOUR SETUP</p>
                        <div style="display: flex; overflow-x: auto;">
                            <div style="height: 100px; width: 150px; border: 1px solid black; background-color: blue;"></div>
                            
        
                        </div>

                    </div>

            
                </main>

            </div>

    </main>

    <main id="sendMo" style="text-align: center; display: none; border: 1px solid black; height: 300px; width: 200px; margin: auto; background-color: blue;">
        
            
            <input type="number" id="ActNo" placeholder="Enter Account to credit" value=""> <br> <br>

            <input type="number" id="Amount1" placeholder="Enter Amount"> <br> <br>

            <input type="submit" id="send" value="Submit" onclick="sending()" style="background-color: green;"> <br> <br>

           
      
    </main>


    <!-- <main id="sendMo1" style="text-align: center; display: none; border: 1px solid black; height: 300px; width: 200px; margin: auto; background-color: blue;">
        
            
        <input type="number" id="ActNo" placeholder="Enter Account to credit" value=""> <br> <br>

        <input type="number" id="Amount1" placeholder="Enter Amount"> <br> <br>

        <input type="submit" id="send" value="Submit" onclick="sending()" style="background-color: green;"> <br> <br>

       
  
</main> -->

        
            <main id="confirmBox" style="color: white; text-align: center; display: none; border: 0px solid black; height: 300px; width: 700px; margin: auto; background-color: blue; ">
                <h5 id="confirmtn">here</h5>
    
            </main>
        


   <script src="prjct.js"></script>
   

   <script>



let welcome = document.getElementById("dashName");
let storedDashData = JSON.parse(localStorage.getItem("RegUsers")) || [];
let loginUserName = JSON.parse(localStorage.getItem("loginUserName")) || [];

let AccountNo = document.getElementById("ActNoDisplay")

console.log(storedDashData);
console.log(loginUserName);




let balAccount1 = document.getElementById("balAccount")
 //let balAccount12 = balAccount1.innerHTML

 balAccount1.innerHTML = parseFloat(loginUserName.balance)







welcome.innerHTML = "Welcome " + loginUserName.username
AccountNo.innerHTML = "Act No: " + loginUserName.accountNo



let sendMon = document.getElementById("sendMo")
let dashbd = document.getElementById("dashbd")

function savMoney(){

sendMon.style.display = "block"
dashbd.style.display = "none"
}




//let existingPhone = loginUserName.some(user => user.phone === phoneNumber1)

let actTocredit = document.getElementById("ActNo")
let amtToSend = document.getElementById("Amount1")

let comfirmtn1 = document.getElementById("confirmtn")

let confirmBox1 = document.getElementById("confirmBox")



function sending(){

    let actTocredit1 = parseFloat(actTocredit.value.trim())    

    let amtToSend1 = parseFloat(amtToSend.value)

   let accountExists = storedDashData.find(user => user.accountNo === actTocredit1);

if (accountExists) {



        if(amtToSend1){

    sendMo.style.display = "none";
    dashbd.style.display = "none";
    confirmBox1.style.display = "block";

    comfirmtn1.innerHTML = `You are trying to send ${amtToSend1} to 
                        ${accountExists.username}
                        <button type="button" style="background-color: green;" onclick = "yesSend()">Yes</button>
                        <button type="button" style="background-color: red;" onclick= "noSend()">No</button>`;
        } else {
          alert ("Enter Amount")
        }

    } else {
        alert("Incorect Account No");
    }
}

 function noSend(){
    sendMo.style.display = "block"
    dashbd.style.display = "none"
    confirmBox1.style.display = "none"
 }


function handleTransfer(sender, receiverActNo, amount){
    let senderData = storedDashData.find(user =>user.username === sender)
    let receiverData = storedDashData.find(user => user.accountNo === receiverActNo)

    if(senderData && receiverData){

        let senderBal = senderData.balance
        let receiverBal = receiverData.balance

        if(senderBal >= amount){

            
            
            senderData.balance -= amount
            receiverData.balance += amount

            localStorage.setItem("Regusers", JSON.stringify(storedDashData))
            return true //Transfer Successful
        } else{
            return false //insufiecient Fund
        }

    } else{
        return false  // Sender or Receive not found
    }

}

function yesSend(){
    let sender = loginUserName.username
    let receiverActNo = parseFloat(actTocredit.value.trim())
    let amount = parseFloat(amtToSend.value)
    let receiverName = storedDashData.find(user => user.accountNo === receiverActNo)

    

    if (handleTransfer(sender, receiverActNo, amount)){

        comfirmtn1.innerHTML = `Tranfer Successful <br>
                              Sender: ${sender} <br>
                                Amount: ${amount} <br>
                                Recepient: ${receiverName.username}(${receiverActNo}) <br>
                                <button type ="button" onclick = "Completed()" style ="background-color: yellow">Press Ok</button>`;



        let senderBalance = document.getElementById("balAccount")



        senderBalance.innerHTML = storedDashData.find(user => user.username === sender).balance.toFixed(2)

       // let receiverBalance = document.getElementById("balForReceiver")

       // receiverBalance.innerHTML = storedDashData.find(user => user.accountNo === receiverActNo).balance.toFixed(2)
       
       
    } else{
        comfirmtn1.innerHTML = "Tranfer failed. Check details"
    }
}




function Completed(){

            
            dashbd.style.display = "block"
            confirmBox1.style.display = "none"; 
            
}

//Completed()


   </script>
   
</body>

</html>